/** * @package Feedback * @version 1.0.3 * @author Sergey Osipov <info@devstratum.ru> * @website https://devstratum.ru * @copyright (c) 2022 Sergey Osipov. All Rights Reserved * @license GNU GPL v2.0 * @report https://github.com/devstratum/feedback/issues */
document.addEventListener("DOMContentLoaded",function(){function e(e,t){document.getElementById("mod_feedback_"+e).querySelector(".mod-feedback__alert").innerHTML='<div class="mod-alert mod-alert-'+t.type+'">'+t.text+"</div>"}document.querySelectorAll(".mod-feedback__privacy .privacy-checkbox").forEach(function(e){e.addEventListener("click",function(){let e=this.getAttribute("data-form-id"),t=document.getElementById("mod_feedback_"+e).querySelector(".mod-feedback__submit .button-submit");this.classList.contains("checked")?(this.classList.remove("checked"),t.classList.add("disabled"),t.setAttribute("disabled","1")):(this.classList.add("checked"),t.classList.remove("disabled"),t.removeAttribute("disabled"))})}),document.querySelectorAll(".mod-feedback__submit .button-submit").forEach(function(t){t.addEventListener("click",function(){let t=this.getAttribute("data-form-id");this.getAttribute("disabled")||function(t){let o=document.getElementById("mod_feedback_"+t),d=o.querySelectorAll(".mod-input"),c=o.querySelector(".mod-feedback__submit .button-submit"),r=o.querySelector(".mod-feedback__progress"),n={};c.classList.add("freeze"),c.setAttribute("disabled","1"),r.classList.add("active"),d.forEach(function(e){let t=e.getAttribute("type");"file"!==t&&(n[e.getAttribute("name")]=e.value)}),setTimeout(function(){!function(t,o){Joomla.request({url:"?option=com_ajax&module=feedback&format=json",method:"POST",headers:{"Cache-Control":"no-cache","Content-Type":"application/json"},data:JSON.stringify({mod_id:t,fields:o}),onBefore:function(){},onSuccess:function(o){let d=JSON.parse(o);0!==d.length&&(function(e){let t=document.getElementById("mod_feedback_"+e),o=t.querySelector(".mod-feedback__alert"),d=t.querySelectorAll(".mod-feedback__field");o.innerHTML="",d.forEach(function(e){e.querySelector(".mod-feedback__input").classList.remove("error"),e.querySelector(".mod-feedback__error").textContent=""})}(t),e(t,d.message),function(e,t){if(0!==t.length&&t.errors){let o=document.getElementById("mod_feedback_"+e);t.errors.forEach(function(e){let t=o.querySelector(".feedback-field_"+e.key+" .mod-feedback__input"),d=o.querySelector(".feedback-field_"+e.key+" .mod-feedback__error");t.classList.add("error"),d.textContent=e.error})}}(t,d.data))},onError:function(){e(t,{type:"danger",text:"Error: unable to send a message"})},onComplete:function(){let e=document.getElementById("mod_feedback_"+t),o=e.querySelector(".mod-feedback__submit .button-submit"),d=e.querySelector(".mod-feedback__progress");o.classList.remove("freeze"),o.removeAttribute("disabled"),d.classList.remove("active")}})}(t,n)},300)}(t)})})});